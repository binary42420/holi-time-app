/**
 * Fix Base64 Format Script
 * 
 * Fixes base64 strings that have the wrong format (semicolon instead of comma)
 */

const fs = require('fs');

function fixBase64Format(base64String) {
  // Check if it has the wrong format
  if (base64String.includes('base64/')) {
    // Replace 'base64/' with 'base64,'
    return base64String.replace('base64/', 'base64,');
  }
  return base64String;
}

function fixBase64File(inputFile, outputFile) {
  try {
    const data = JSON.parse(fs.readFileSync(inputFile, 'utf8'));
    
    // Fix each result
    if (data.results) {
      data.results.forEach(result => {
        if (result.base64) {
          result.base64 = fixBase64Format(result.base64);
        }
      });
    }
    
    // Save fixed data
    fs.writeFileSync(outputFile, JSON.stringify(data, null, 2));
    console.log(`‚úÖ Fixed base64 format in ${outputFile}`);
    
  } catch (error) {
    console.error('‚ùå Error:', error.message);
  }
}

// Example usage
const wrongFormat = "data:image/jpeg;base64/9j/4AAQSkZJRgABAQAAAQABAAD/...";
const correctFormat = fixBase64Format(wrongFormat);

console.log('üîß Base64 Format Fixer');
console.log('======================');
console.log('Wrong format:  ', wrongFormat.substring(0, 30) + '...');
console.log('Correct format:', correctFormat.substring(0, 30) + '...');
console.log('');
console.log('‚úÖ The correct format uses a COMMA after base64, not a forward slash');
console.log('');

// Test with your exact string
const yourString = "data:image/jpeg;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";
const fixedString = fixBase64Format(yourString);

console.log('Your string (wrong):');
console.log(yourString.substring(0, 50) + '...');
console.log('');
console.log('Fixed string (correct):');
console.log(fixedString.substring(0, 50) + '...');

// If you have a results file to fix:
// fixBase64File('avatar-base64-results.json', 'avatar-base64-results-fixed.json');

module.exports = { fixBase64Format, fixBase64File };